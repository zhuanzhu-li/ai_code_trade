# è„šæœ¬è¯´æ˜æ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜é¡¹ç›®ä¸­æ‰€æœ‰å¯ç”¨çš„npmè„šæœ¬å’Œæµ‹è¯•è„šæœ¬çš„åŠŸèƒ½ã€‚

## NPM è„šæœ¬

### å¼€å‘ç›¸å…³è„šæœ¬

| è„šæœ¬ | å‘½ä»¤ | æè¿° |
|------|------|------|
| `dev` | `vite` | å¯åŠ¨å¼€å‘æœåŠ¡å™¨ |
| `build` | `vue-tsc && vite build` | æ„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼ˆåŒ…å«ç±»å‹æ£€æŸ¥ï¼‰ |
| `preview` | `vite preview` | é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬ |

### ä»£ç è´¨é‡è„šæœ¬

| è„šæœ¬ | å‘½ä»¤ | æè¿° |
|------|------|------|
| `lint` | `eslint . --ext .vue,.js,.jsx,.cjs,.mjs,.ts,.tsx,.cts,.mts --fix` | è¿è¡ŒESLintæ£€æŸ¥å¹¶è‡ªåŠ¨ä¿®å¤ |
| `type-check` | `vue-tsc --noEmit` | TypeScriptç±»å‹æ£€æŸ¥ |

### æµ‹è¯•è„šæœ¬

#### åŸºç¡€æµ‹è¯•è„šæœ¬
| è„šæœ¬ | å‘½ä»¤ | æè¿° |
|------|------|------|
| `test` | `npx vitest` | å¯åŠ¨æµ‹è¯•ç›‘è§†æ¨¡å¼ |
| `test:run` | `npx vitest run` | è¿è¡Œä¸€æ¬¡æµ‹è¯• |
| `test:ui` | `npx vitest --ui` | å¯åŠ¨æµ‹è¯•UIç•Œé¢ |
| `test:watch` | `npx vitest --watch` | ç›‘è§†æ¨¡å¼è¿è¡Œæµ‹è¯• |

#### è¦†ç›–ç‡æµ‹è¯•è„šæœ¬
| è„šæœ¬ | å‘½ä»¤ | æè¿° |
|------|------|------|
| `test:coverage` | `npx vitest run --coverage` | è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š |
| `test:ci` | `npx vitest run --reporter=verbose --coverage` | CIç¯å¢ƒæµ‹è¯•ï¼ˆè¯¦ç»†è¾“å‡ºï¼‰ |

#### ç»¼åˆæµ‹è¯•è„šæœ¬
| è„šæœ¬ | å‘½ä»¤ | æè¿° |
|------|------|------|
| `test:all` | `npm run type-check && npm run lint && npm run test:coverage` | è¿è¡Œå®Œæ•´æ£€æŸ¥æµç¨‹ |
| `test:full` | `node scripts/test.js` | è·¨å¹³å°å®Œæ•´æµ‹è¯•è„šæœ¬ |
| `test:win` | `scripts\\test.bat` | Windowsæ‰¹å¤„ç†æµ‹è¯•è„šæœ¬ |
| `test:unix` | `scripts/test.sh` | Unix/Linuxæµ‹è¯•è„šæœ¬ |
| `test:cross` | `node scripts/test.js` | è·¨å¹³å°Node.jsæµ‹è¯•è„šæœ¬ |

### ç»´æŠ¤è„šæœ¬

| è„šæœ¬ | å‘½ä»¤ | æè¿° |
|------|------|------|
| `clean` | `rimraf node_modules package-lock.json dist` | æ¸…ç†é¡¹ç›®æ–‡ä»¶ |
| `reinstall` | `npm run clean && npm install` | é‡æ–°å®‰è£…ä¾èµ– |

## æµ‹è¯•è„šæœ¬è¯¦è§£

### 1. Windowsæ‰¹å¤„ç†è„šæœ¬ (`scripts/test.bat`)

**åŠŸèƒ½ç‰¹æ€§:**
- è‡ªåŠ¨æ£€æŸ¥Node.jså’Œnpmç‰ˆæœ¬
- è‡ªåŠ¨å®‰è£…ç¼ºå¤±çš„ä¾èµ–
- è¿è¡ŒTypeScriptç±»å‹æ£€æŸ¥
- è¿è¡ŒESLintä»£ç æ£€æŸ¥
- è¿è¡Œå•å…ƒæµ‹è¯•
- ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
- **è‡ªåŠ¨æ£€æŸ¥è¦†ç›–ç‡æ˜¯å¦è¾¾åˆ°50%é˜ˆå€¼**
- æ”¯æŒä¸­æ–‡è¾“å‡ºå’Œé”™è¯¯å¤„ç†

**ä½¿ç”¨æ–¹æ³•:**
```bash
# é€šè¿‡npmè¿è¡Œ
npm run test:win

# æˆ–ç›´æ¥è¿è¡Œ
cd frontpoint
scripts\test.bat
```

**è¦†ç›–ç‡æ£€æŸ¥åŠŸèƒ½:**
- è‡ªåŠ¨è°ƒç”¨ `scripts/check-coverage.js` æ£€æŸ¥è¦†ç›–ç‡
- å¦‚æœè¦†ç›–ç‡ä½äº50%ï¼Œè„šæœ¬ä¼šå¤±è´¥å¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
- æä¾›æ”¹è¿›å»ºè®®

### 2. è¦†ç›–ç‡æ£€æŸ¥è„šæœ¬ (`scripts/check-coverage.js`)

**åŠŸèƒ½ç‰¹æ€§:**
- è§£æ `coverage/coverage-final.json` æ–‡ä»¶
- è®¡ç®—è¯­å¥ã€åˆ†æ”¯ã€å‡½æ•°ã€è¡Œè¦†ç›–ç‡
- è®¡ç®—å¹³å‡è¦†ç›–ç‡
- æ”¯æŒè‡ªå®šä¹‰é˜ˆå€¼
- æä¾›è¯¦ç»†çš„è¦†ç›–ç‡ç»Ÿè®¡
- ä»¥é€‚å½“çš„é€€å‡ºä»£ç ç»“æŸï¼ˆ0=æˆåŠŸï¼Œ1=å¤±è´¥ï¼‰

**ä½¿ç”¨æ–¹æ³•:**
```bash
# ä½¿ç”¨é»˜è®¤é˜ˆå€¼ï¼ˆ50%ï¼‰
node scripts/check-coverage.js

# ä½¿ç”¨è‡ªå®šä¹‰é˜ˆå€¼
node scripts/check-coverage.js 80

# æ£€æŸ¥æ˜¯å¦è¾¾åˆ°é¡¹ç›®é…ç½®çš„80%é˜ˆå€¼
node scripts/check-coverage.js 80
```

**è¾“å‡ºç¤ºä¾‹:**
```
ğŸ” æ£€æŸ¥æµ‹è¯•è¦†ç›–ç‡...
ğŸ“Š è¦†ç›–ç‡æŠ¥å‘Š:
   è¯­å¥è¦†ç›–ç‡: 37.13% (504/1357)
   åˆ†æ”¯è¦†ç›–ç‡: 82.21% (134/163)
   å‡½æ•°è¦†ç›–ç‡: 57.45% (27/47)
   è¡Œè¦†ç›–ç‡: 37.13% (504/1357)
   å¹³å‡è¦†ç›–ç‡: 53.48%
âœ… è¦†ç›–ç‡æ£€æŸ¥é€šè¿‡ï¼å¹³å‡è¦†ç›–ç‡ 53.48% >= 50%
```

### 3. è·¨å¹³å°æµ‹è¯•è„šæœ¬ (`scripts/test.js`)

**åŠŸèƒ½ç‰¹æ€§:**
- æ”¯æŒWindowsã€macOSã€Linux
- Node.jså®ç°ï¼Œæ— éœ€é¢å¤–ä¾èµ–
- åŒ…å«å®Œæ•´çš„æµ‹è¯•æµç¨‹
- è‡ªåŠ¨é”™è¯¯å¤„ç†å’Œé€€å‡ºä»£ç 
- å½©è‰²è¾“å‡ºæ”¯æŒ

## è¦†ç›–ç‡é…ç½®

### Vitesté…ç½® (`vitest.config.ts`)

é¡¹ç›®åœ¨ `vitest.config.ts` ä¸­é…ç½®äº†è¦†ç›–ç‡é˜ˆå€¼ï¼š

```typescript
coverage: {
  provider: 'v8',
  reporter: ['text', 'json', 'html'],
  thresholds: {
    global: {
      branches: 80,
      functions: 80,
      lines: 80,
      statements: 80
    }
  }
}
```

### è¦†ç›–ç‡æ–‡ä»¶æ’é™¤

ä»¥ä¸‹æ–‡ä»¶å’Œç›®å½•è¢«æ’é™¤åœ¨è¦†ç›–ç‡ç»Ÿè®¡ä¹‹å¤–ï¼š
- `node_modules/`
- `src/test/`
- `**/*.d.ts`
- `**/*.config.*`
- `**/coverage/**`
- `**/dist/**`

## æœ€ä½³å®è·µ

### 1. æ—¥å¸¸å¼€å‘
```bash
# å¼€å‘æ—¶è¿è¡Œç›‘è§†æ¨¡å¼
npm run test:watch

# æäº¤å‰è¿è¡Œå®Œæ•´æ£€æŸ¥
npm run test:all
```

### 2. æŒç»­é›†æˆ
```bash
# CIç¯å¢ƒä½¿ç”¨è¯¦ç»†è¾“å‡º
npm run test:ci

# æˆ–ä½¿ç”¨è·¨å¹³å°è„šæœ¬
npm run test:full
```

### 3. è¦†ç›–ç‡ç›‘æ§
```bash
# å®šæœŸæ£€æŸ¥è¦†ç›–ç‡
npm run test:coverage

# åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š
open coverage/index.html
```

## æ•…éšœæ’é™¤

### 1. è¦†ç›–ç‡æ£€æŸ¥å¤±è´¥
```bash
# æŸ¥çœ‹è¯¦ç»†è¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
open coverage/index.html

# ä½¿ç”¨è¾ƒä½é˜ˆå€¼ä¸´æ—¶é€šè¿‡ï¼ˆä¸æ¨èï¼‰
node scripts/check-coverage.js 30
```

### 2. è„šæœ¬æ‰§è¡Œå¤±è´¥
```bash
# æ£€æŸ¥Node.jsç‰ˆæœ¬
node --version

# é‡æ–°å®‰è£…ä¾èµ–
npm run reinstall

# æ¸…ç†å¹¶é‡æ–°å¼€å§‹
npm run clean
npm install
```

### 3. Windowsç‰¹å®šé—®é¢˜
- ç¡®ä¿ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œå‘½ä»¤æç¤ºç¬¦
- æ£€æŸ¥PowerShellæ‰§è¡Œç­–ç•¥
- ç¡®ä¿npm.cmdåœ¨PATHä¸­

## æ‰©å±•è„šæœ¬

å¦‚éœ€æ·»åŠ æ–°çš„æµ‹è¯•è„šæœ¬ï¼Œè¯·ï¼š

1. åœ¨ `scripts/` ç›®å½•åˆ›å»ºè„šæœ¬æ–‡ä»¶
2. åœ¨ `package.json` ä¸­æ·»åŠ å¯¹åº”çš„npmè„šæœ¬
3. æ›´æ–°æœ¬æ–‡æ¡£
4. ç¡®ä¿è„šæœ¬åŒ…å«é€‚å½“çš„é”™è¯¯å¤„ç†å’Œé€€å‡ºä»£ç 

## ç›¸å…³æ–‡æ¡£

- [TESTING.md](./TESTING.md) - è¯¦ç»†æµ‹è¯•æŒ‡å—
- [README.md](./README.md) - é¡¹ç›®æ€»è§ˆ
- [vitest.config.ts](./vitest.config.ts) - æµ‹è¯•é…ç½®
